# System Configuration for Modern Tunneling Autoscript
# This file contains system-wide configuration settings

# =============================================================================
# BASIC SYSTEM SETTINGS
# =============================================================================

# System information
SCRIPT_NAME="Yuipedia Tunneling"
SCRIPT_VERSION="2.0.0"
SCRIPT_AUTHOR="Yuipedia"

# Supported OS versions
SUPPORTED_UBUNTU_MIN="22.04"
SUPPORTED_DEBIAN_MIN="11"

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================

# Default ports for services
SSH_PORT="22"
DROPBEAR_PORT="109"
DROPBEAR_PORT_WS="143"
XRAY_VMESS_PORT="8080"
XRAY_VMESS_TLS_PORT="443"
XRAY_VLESS_PORT="8081"
XRAY_VLESS_TLS_PORT="443"
XRAY_TROJAN_PORT="8443"
WEBSOCKET_PORT="8880"
OPENVPN_PORT="1194"

# Domain configuration
DEFAULT_DOMAIN=""
USE_DOMAIN="false"

# =============================================================================
# SECURITY SETTINGS
# =============================================================================

# Password requirements
MIN_PASSWORD_LENGTH="8"
MAX_PASSWORD_LENGTH="128"
REQUIRE_SPECIAL_CHARS="true"

# Username requirements
MIN_USERNAME_LENGTH="3"
MAX_USERNAME_LENGTH="32"

# Account expiry settings
DEFAULT_ACCOUNT_VALIDITY="30"  # days
MAX_ACCOUNT_VALIDITY="365"     # days

# SSH security settings
SSH_PERMIT_ROOT_LOGIN="no"
SSH_PASSWORD_AUTHENTICATION="yes"
SSH_PUBKEY_AUTHENTICATION="yes"
SSH_MAX_AUTH_TRIES="3"
SSH_CLIENT_ALIVE_INTERVAL="60"
SSH_CLIENT_ALIVE_COUNT_MAX="3"

# =============================================================================
# SERVICE CONFIGURATION
# =============================================================================

# Enable/disable services
ENABLE_SSH="true"
ENABLE_DROPBEAR="true"
ENABLE_XRAY="true"
ENABLE_WEBSOCKET="true"
ENABLE_OPENVPN="false"  # Will be implemented later

# Xray configuration
XRAY_CONFIG_PATH="/usr/local/etc/xray"
XRAY_LOG_PATH="/var/log/xray"
XRAY_LOG_LEVEL="warning"

# WebSocket configuration
WEBSOCKET_PATH="/ws"
WEBSOCKET_HOST="0.0.0.0"

# =============================================================================
# SYSTEM OPTIMIZATION
# =============================================================================

# Performance settings
ENABLE_BBR="true"
ENABLE_SWAP="true"
SWAP_SIZE="1G"

# Firewall settings
ENABLE_UFW="true"
DEFAULT_POLICY_INCOMING="deny"
DEFAULT_POLICY_OUTGOING="allow"

# Fail2ban settings
ENABLE_FAIL2BAN="true"
FAIL2BAN_BANTIME="3600"
FAIL2BAN_FINDTIME="600"
FAIL2BAN_MAXRETRY="5"

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log levels: DEBUG, INFO, WARN, ERROR, FATAL
LOG_LEVEL="INFO"
LOG_TO_FILE="true"
LOG_TO_CONSOLE="true"
LOG_ROTATION="true"
MAX_LOG_SIZE="10M"
MAX_LOG_FILES="5"

# Log paths
LOG_DIR="/var/log/autoscript"
MAIN_LOG_FILE="${LOG_DIR}/autoscript.log"
ERROR_LOG_FILE="${LOG_DIR}/error.log"
ACCESS_LOG_FILE="${LOG_DIR}/access.log"

# =============================================================================
# ACCOUNT MANAGEMENT
# =============================================================================

# Account storage
ACCOUNT_DATA_DIR="/etc/autoscript/accounts"
SSH_ACCOUNT_FILE="${ACCOUNT_DATA_DIR}/ssh.txt"
XRAY_ACCOUNT_FILE="${ACCOUNT_DATA_DIR}/xray.txt"

# Account limits
MAX_ACCOUNTS_PER_TYPE="1000"
ACCOUNT_CLEANUP_INTERVAL="3600"  # seconds

# =============================================================================
# BACKUP AND MAINTENANCE
# =============================================================================

# Backup settings
ENABLE_BACKUP="true"
BACKUP_DIR="/backup/autoscript"
BACKUP_RETENTION_DAYS="7"

# Maintenance settings
AUTO_UPDATE="false"
UPDATE_CHECK_INTERVAL="86400"  # seconds
CLEANUP_LOGS_INTERVAL="10800"  # seconds (3 hours)

# =============================================================================
# INSTALLATION PATHS
# =============================================================================

# Main installation directory
INSTALL_DIR="/opt/autoscript"
BIN_DIR="/usr/local/bin"
CONFIG_DIR="/etc/autoscript"
DATA_DIR="/var/lib/autoscript"

# Script paths
SCRIPT_DIR="${INSTALL_DIR}/scripts"
UTILS_DIR="${INSTALL_DIR}/utils"
MENU_SCRIPT="${BIN_DIR}/autoscript"

# =============================================================================
# EXTERNAL DEPENDENCIES
# =============================================================================

# Required packages
REQUIRED_PACKAGES=(
    "curl"
    "wget"
    "unzip"
    "tar"
    "gzip"
    "jq"
    "bc"
    "uuid-runtime"
    "net-tools"
    "lsof"
    "htop"
    "nano"
    "vim"
    "cron"
    "logrotate"
)

# Optional packages
OPTIONAL_PACKAGES=(
    "ufw"
    "fail2ban"
    "iptables-persistent"
    "screen"
    "tmux"
)

# =============================================================================
# DOWNLOAD URLS
# =============================================================================

# Xray-core download URL
XRAY_DOWNLOAD_URL="https://github.com/XTLS/Xray-core/releases/latest/download"

# Dropbear download URL
DROPBEAR_DOWNLOAD_URL="https://matt.ucc.asn.au/dropbear/releases"

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Feature toggles
ENABLE_AUTO_CLEANUP="true"
ENABLE_BANDWIDTH_MONITORING="false"
ENABLE_ACCOUNT_NOTIFICATIONS="false"
ENABLE_WEB_PANEL="false"

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================

# Debug settings
DEBUG_MODE="false"
VERBOSE_OUTPUT="false"
DRY_RUN="false"

# Testing settings
SKIP_COMPATIBILITY_CHECK="false"
ALLOW_NON_ROOT="false"

# =============================================================================
# END OF CONFIGURATION
# =============================================================================